{"version":3,"sources":["webpack:///./src/app/users/exchange/exchange.module.ts","webpack:///./src/app/users/exchange/exchange.page.html","webpack:///./src/app/users/exchange/exchange.page.scss","webpack:///./src/app/users/exchange/exchange.page.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;AAAyC;AACM;AACF;AACU;AAEV;AAEE;AACU;AAEzD,IAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,EAAE;QACR,SAAS,EAAE,2DAAY;KACxB;CACF,CAAC;AAYF;IAAA;IAAiC,CAAC;IAArB,kBAAkB;QAV9B,8DAAQ,CAAC;YACR,OAAO,EAAE;gBACP,4DAAY;gBACZ,0DAAW;gBACX,0DAAW;gBACX,sEAAc;gBACd,4DAAY,CAAC,QAAQ,CAAC,MAAM,CAAC;aAC9B;YACD,YAAY,EAAE,CAAC,2DAAY,CAAC;SAC7B,CAAC;OACW,kBAAkB,CAAG;IAAD,yBAAC;CAAA;AAAH;;;;;;;;;;;;AC3B/B,k1BAAk1B,ugBAAugB,mCAAmC,iDAAiD,0FAA0F,mCAAmC,oDAAoD,kGAAkG,8BAA8B,qDAAqD,+BAA+B,2OAA2O,wBAAwB,wqB;;;;;;;;;;;ACArjE,+DAA+D,mJ;;;;;;;;;;;;;;;;;;;;;;;ACAF;AACS;AAC1B;AAEG;AACL;AACQ;AACiC;AAEnF,mIAAmI;AAUnI;IAkBE,mIAAmI;IAEnI,sBAAmB,iBAAoC,EAC7C,GAAuB,EACvB,KAAY;QAFH,sBAAiB,GAAjB,iBAAiB,CAAmB;QAC7C,QAAG,GAAH,GAAG,CAAoB;QACvB,UAAK,GAAL,KAAK,CAAO;QAhBtB,mIAAmI;QAElH,cAAS,GAAG,gBAAgB,CAAC;QAE9C,mIAAmI;QAE3H,YAAO,GAAoB,IAAI,KAAK,EAAY,CAAC;QAClD,eAAU,GAAoB,IAAI,KAAK,EAAY,CAAC;QACpD,iBAAY,GAAoB,IAAI,KAAK,EAAY,CAAC;QAEtD,sBAAiB,GAAG,uDAAK,CAAC,oBAAoB,EAAE,CAAC;QAOtD,IAAM,SAAS,GAAG,IAAI,CAAC,SAAS,GAAG,eAAe,CAAC;QACnD,IAAI,CAAC,UAAU,EAAE,CAAC;IACpB,CAAC;IAED,mIAAmI;IAEnI,iCAAU,GAAV;QAAA,iBAUC;QATC,IAAI,CAAC,GAAG,CAAC,gBAAgB,EAAE,CAAC,IAAI,CAAC,UAAC,UAAyB;YACzD,KAAI,CAAC,iBAAiB,GAAG,uDAAK,CAAC,oBAAoB,EAAE,CAAC;YACtD,IAAI,OAAO,GAAG,IAAI,KAAK,EAAY,CAAC;YACpC,KAAmB,UAAU,EAAV,yBAAU,EAAV,wBAAU,EAAV,IAAU,EAAE;gBAA1B,IAAI,MAAM;gBACb,OAAO,CAAC,IAAI,CAAC,IAAI,4DAAQ,CAAC,MAAM,CAAC,CAAC,CAAC;aACpC;YACD,KAAI,CAAC,OAAO,GAAG,OAAO;YACtB,KAAI,CAAC,UAAU,GAAG,KAAI,CAAC,OAAO,CAAC;QACjC,CAAC,CAAC,CAAC,KAAK,CAAC,UAAC,KAAK,IAAK,YAAI,CAAC,KAAK,CAAC,WAAW,CAAC,KAAK,GAAG,IAAI,GAAG,+DAAS,CAAC,oBAAoB,CAAC,EAArE,CAAqE,CAAC,CAAC;IAC7F,CAAC;IAED,mIAAmI;IAEnI,6BAAM,GAAN,UAAO,GAAG;QACR,IAAM,SAAS,GAAG,IAAI,CAAC,SAAS,GAAG,UAAU,CAAC;QAC9C,uDAAK,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;QACrB,IAAI,uDAAK,CAAC,eAAe,CAAC,GAAG,CAAC,EAAE;YAC9B,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,OAAO,CAAC;YAC/B,OAAO;SACR;QACD,IAAM,UAAU,GAAG,GAAG,CAAC;QACvB,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;QAC7B,IAAI,CAAC,UAAU,EAAE;YACf,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,OAAO,CAAC;YAC/B,OAAO;SACR;QACD,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,WAAC,IAAI,QAAC,CAAC,SAAS,EAAE,CAAC,OAAO,EAAE,CAAC,WAAW,EAAE,CAAC,QAAQ,CAAC,UAAU,CAAC,WAAW,EAAE,CAAC,IAAI,CAAC,CAAC,SAAS,EAAE,CAAC,YAAY,EAAE,CAAC,WAAW,EAAE,CAAC,QAAQ,CAAC,UAAU,CAAC,WAAW,EAAE,CAAC,EAAzJ,CAAyJ,CAAC,CAAC;IACxM,CAAC;IAED,mIAAmI;IAEnI,mCAAY,GAAZ,UAAa,IAAc;QACzB,IAAM,SAAS,GAAG,IAAI,CAAC,SAAS,GAAG,gBAAgB,CAAC;QACpD,IAAI,IAAI,CAAC,SAAS,EAAE,CAAC,aAAa,EAAE,GAAG,IAAI,CAAC,aAAa,EAAE,IAAI,uDAAK,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC,aAAa,EAAE,CAAC,EAAE;YACnH,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;SACvB;IACH,CAAC;IAED,mIAAmI;IAEnI,mCAAY,GAAZ,UAAa,IAAc;QACzB,IAAM,SAAS,GAAG,IAAI,CAAC,SAAS,GAAG,gBAAgB,CAAC;QACpD,IAAI,IAAI,CAAC,aAAa,EAAE,GAAG,CAAC,EAAE;YAC5B,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC;SACxB;IACH,CAAC;IAED,mIAAmI;IAE7H,+BAAQ,GAAd,UAAe,EAAO;;;;;;wBACd,SAAS,GAAG,IAAI,CAAC,SAAS,GAAG,YAAY,CAAC;6BAC5C,CAAC,uDAAK,CAAC,cAAc,CAAC,IAAI,CAAC,YAAY,CAAC,EAAxC,wBAAwC;wBAC1B,qBAAM,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC;gCAClD,SAAS,EAAE,wDAAQ;gCACnB,KAAK,EAAE,EAAE;gCACT,WAAW,EAAE,IAAI;gCACjB,QAAQ,EAAE,gBAAgB;gCAC1B,cAAc,EAAE;oCACd,IAAI,EAAE,IAAI,CAAC,YAAY;iCACxB;6BACF,CAAC;;wBARI,OAAO,GAAG,SAQd;wBACK,qBAAM,OAAO,CAAC,OAAO,EAAE;4BAA9B,sBAAO,SAAuB,EAAC;;wBAG/B,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,+DAAS,CAAC,UAAU,CAAC,CAAC;;;;;;KAGrD;IAED,mIAAmI;IAEnI,gCAAS,GAAT,UAAU,IAAc;QACtB,IAAM,SAAS,GAAG,IAAI,CAAC,SAAS,GAAG,aAAa,CAAC;QACjD,uDAAK,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;QACrB,IAAI,QAAQ,GAAC,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,WAAC,IAAI,QAAC,CAAC,SAAS,EAAE,CAAC,KAAK,EAAE,IAAI,IAAI,CAAC,SAAS,EAAE,CAAC,KAAK,EAAE,EAAjD,CAAiD,CAAC,CAAC,CAAC,CAAC,CAAC;QACjG,IAAI,QAAQ,GAAC,IAAI,KAAK,EAAO,CAAC;QAC9B,IAAG,CAAC,uDAAK,CAAC,YAAY,CAAC,QAAQ,CAAC,EAAC;YAC/B,QAAQ,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,CAAC;SAC7E;QACD,IAAI,IAAI,CAAC,aAAa,EAAE,GAAG,CAAC,EAAE;YAC5B,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAC7B,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,+DAAS,CAAC,gBAAgB,CAAC,CAAC;SACpD;aACI,IAAI,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;YAC5B,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,+DAAS,CAAC,iBAAiB,CAAC,CAAC;SACrD;IACH,CAAC;IAED,mIAAmI;IAEnI,+BAAQ,GAAR,UAAS,KAAK;QAAd,iBASC;QARC,UAAU,CAAC;YACT,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;YACpB,KAAK,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAC;YACxB,KAAI,CAAC,iBAAiB,GAAG,uDAAK,CAAC,oBAAoB,EAAE,CAAC;YACtD,IAAI,KAAI,CAAC,UAAU,CAAC,MAAM,IAAI,IAAI,EAAE;gBAClC,KAAK,CAAC,MAAM,CAAC,QAAQ,GAAG,IAAI,CAAC;aAC9B;QACH,CAAC,EAAE,GAAG,CAAC,CAAC;IACV,CAAC;IA9H6B;QAA7B,+DAAS,CAAC,gEAAiB,CAAC;wEAAiB,gEAAiB;wDAAC;IAHrD,YAAY;QARxB,+DAAS,CAAC;YACT,QAAQ,EAAE,cAAc;YACxB,wGAAmC;;SAEpC,CAAC;QAEF,mIAAmI;;+EAsB3F,gEAAiB;YACxC,gGAAkB;YAChB,uDAAK;OAtBX,YAAY,CAqIxB;IAAD,mBAAC;CAAA;AArIwB","file":"users-exchange-exchange-module.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { ExchangePage } from './exchange.page';\r\nimport { MaterialModule } from 'src/app/material.module';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: ExchangePage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    MaterialModule,\r\n    RouterModule.forChild(routes)\r\n  ],\r\n  declarations: [ExchangePage]\r\n})\r\nexport class ExchangePageModule {}\r\n","module.exports = \"<ion-header>\\r\\n  <ion-toolbar>\\r\\n    <ion-buttons slot=\\\"start\\\">\\r\\n      <ion-menu-toggle auto-hide=\\\"false\\\"><i class=\\\"fas fa-align-left icon-menu\\\"></i></ion-menu-toggle>\\r\\n    </ion-buttons>\\r\\n  </ion-toolbar>\\r\\n  <ion-toolbar class=\\\"no-radius\\\">\\r\\n    <span class=\\\"title_t\\\">Troca</span>\\r\\n    <span class=\\\"title_w\\\">de Prêmios</span>\\r\\n    <ion-buttons slot=\\\"end\\\">\\r\\n        <ion-back-button text=\\\"\\\" icon=\\\"arrow-back\\\"></ion-back-button>\\r\\n    </ion-buttons>\\r\\n  </ion-toolbar>\\r\\n  \\r\\n  <ion-toolbar>\\r\\n    <ion-searchbar placeholder=\\\"Pesquisar\\\" animated (ionInput)=\\\"filter($event.srcElement.value)\\\"></ion-searchbar>\\r\\n  </ion-toolbar>\\r\\n\\r\\n</ion-header>\\r\\n\\r\\n<ion-content padding=\\\"true\\\">\\r\\n\\r\\n\\r\\n    <ion-fab horizontal=\\\"end\\\" vertical=\\\"top\\\" slot=\\\"fixed\\\" (click)=\\\"openCart($event);\\\">\\r\\n        <ion-fab-button color=\\\"dark\\\">\\r\\n          <ion-icon name=\\\"cart\\\"></ion-icon>\\r\\n        </ion-fab-button>\\r\\n      </ion-fab>\\r\\n\\r\\n\\r\\n      \\r\\n  <ion-grid>\\r\\n\\r\\n    \\r\\n      <div class=\\\"alert alert-warning\\\" role=\\\"alert\\\" [hidden]=\\\"rewardList.length > 0\\\">\\r\\n          Nenhum prêmio disponível no momento.\\r\\n      </div>\\r\\n\\r\\n      <ion-row *ngFor=\\\"let reward of rewardList\\\">\\r\\n        <ion-col>\\r\\n          <div class=\\\"box-prize\\\">        \\r\\n            <div class=\\\"qta-txt\\\">{{reward.getPremio().getDescricao()}}</div>\\r\\n            <div class=\\\"num-prize\\\">{{reward.getPremio().getQuantidade()==null?\\\"Infinito\\\":reward.getPremio().getQuantidade()}}</div>\\r\\n            <img src=\\\"{{reward.getPremio().getFoto()+'?'+imageConcatString}}\\\" onError=\\\"src = '../assets/imgs/no-image.png'\\\">  \\r\\n            <span class=\\\"item-prize\\\">{{reward.getPremio().getNome()}}</span>\\r\\n            <span class=\\\"valor-prize\\\">{{reward.getPremio().getValor()}} Pontos</span>   \\r\\n            \\r\\n            <div class=\\\"block-value\\\">\\r\\n                <button clear (click)=\\\"decrementQty(reward)\\\"><i class=\\\"fas fa-minus-circle\\\"></i></button>\\r\\n                <span class=\\\"box-qty\\\">{{reward.getQuantidade()}}</span>\\r\\n                <button clear (click)=\\\"incrementQty(reward)\\\"><i class=\\\"fas fa-plus-circle\\\"></i></button>\\r\\n            </div>\\r\\n            <div class=\\\"block-footer\\\" >\\r\\n             <span (click)=\\\"addToCart(reward)\\\"> Adicionar ao carrinho</span>\\r\\n            </div>\\r\\n          </div>\\r\\n        </ion-col>\\r\\n      </ion-row>\\r\\n    </ion-grid>\\r\\n\\r\\n    <ion-infinite-scroll threshold=\\\"100px\\\" (ionInfinite)=\\\"loadData($event)\\\">\\r\\n      <ion-infinite-scroll-content\\r\\n        loadingSpinner=\\\"dots\\\"\\r\\n        loadingText=\\\"Carregando mais...\\\">\\r\\n      </ion-infinite-scroll-content>\\r\\n    </ion-infinite-scroll>\\r\\n    \\r\\n</ion-content>\\r\\n\"","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3VzZXJzL2V4Y2hhbmdlL2V4Y2hhbmdlLnBhZ2Uuc2NzcyJ9 */\"","import { Component, OnInit, ViewChild } from '@angular/core';\r\nimport { PopoverController, IonInfiniteScroll } from '@ionic/angular';\r\nimport { CartPage } from './cart/cart.page';\r\nimport { Reward } from 'src/models/Reward';\r\nimport { CartItem } from 'src/models/CartItem';\r\nimport { Utils } from 'src/commons/Utils';\r\nimport { ToastText } from 'src/commons/Constants';\r\nimport { BackendApiProvider } from 'src/providers/backend-api/backend-api.service';\r\n\r\n//-------------------------------------------------------------------------------------------------------------------------------//\r\n\r\n@Component({\r\n  selector: 'app-exchange',\r\n  templateUrl: './exchange.page.html',\r\n  styleUrls: ['./exchange.page.scss'],\r\n})\r\n\r\n//-------------------------------------------------------------------------------------------------------------------------------//\r\n\r\nexport class ExchangePage {\r\n\r\n  \r\n  @ViewChild(IonInfiniteScroll) infiniteScroll: IonInfiniteScroll;\r\n \r\n  \r\n  //-------------------------------------------------------------------------------------------------------------------------------//\r\n\r\n  private readonly logHeader = \"ExchangePage>>\";\r\n\r\n  //-------------------------------------------------------------------------------------------------------------------------------//\r\n\r\n  private rewards: Array<CartItem> = new Array<CartItem>();\r\n  public rewardList: Array<CartItem> = new Array<CartItem>();\r\n  public shoppingCart: Array<CartItem> = new Array<CartItem>();\r\n  private searchTerm: string;\r\n  public imageConcatString = Utils.generateRandomString();\r\n\r\n  //-------------------------------------------------------------------------------------------------------------------------------//\r\n\r\n  constructor(public popoverController: PopoverController,\r\n    private api: BackendApiProvider,\r\n    private utils: Utils) {\r\n    const logHeader = this.logHeader + \"constructor>>\";\r\n    this.getRewards();\r\n  }\r\n\r\n  //-------------------------------------------------------------------------------------------------------------------------------//\r\n\r\n  getRewards() {\r\n    this.api.getActiveRewards().then((rawRewards: Array<Reward>) => {\r\n      this.imageConcatString = Utils.generateRandomString();\r\n      let rewards = new Array<CartItem>();\r\n      for (let reward of rawRewards) {\r\n        rewards.push(new CartItem(reward));\r\n      }\r\n      this.rewards = rewards\r\n      this.rewardList = this.rewards;\r\n    }).catch((error) => this.utils.simpleToast(error + '\\n' + ToastText.SOMETHING_WENT_WRONG));\r\n  }\r\n\r\n  //-------------------------------------------------------------------------------------------------------------------------------//\r\n\r\n  filter(evt) {\r\n    const logHeader = this.logHeader + \"filter>>\";\r\n    Utils.log(logHeader);\r\n    if (Utils.isStringInvalid(evt)) {\r\n      this.rewardList = this.rewards;\r\n      return;\r\n    }\r\n    const searchTerm = evt;\r\n    this.searchTerm = searchTerm;\r\n    if (!searchTerm) {\r\n      this.rewardList = this.rewards;\r\n      return;\r\n    }\r\n    this.rewardList = this.rewards.filter(n => n.getPremio().getNome().toLowerCase().includes(searchTerm.toLowerCase()) || n.getPremio().getDescricao().toLowerCase().includes(searchTerm.toLowerCase()));\r\n  }\r\n\r\n  //-------------------------------------------------------------------------------------------------------------------------------//\r\n\r\n  incrementQty(item: CartItem) {\r\n    const logHeader = this.logHeader + \"incrementQty>>\";\r\n    if (item.getPremio().getQuantidade() > item.getQuantidade() || Utils.isVarInvalid(item.getPremio().getQuantidade())) {\r\n      item.addQuantidade(1);\r\n    }\r\n  }\r\n\r\n  //-------------------------------------------------------------------------------------------------------------------------------//\r\n\r\n  decrementQty(item: CartItem) {\r\n    const logHeader = this.logHeader + \"decrementQty>>\";\r\n    if (item.getQuantidade() > 0) {\r\n      item.addQuantidade(-1);\r\n    }\r\n  }\r\n\r\n  //-------------------------------------------------------------------------------------------------------------------------------//\r\n\r\n  async openCart(ev: any) {\r\n    const logHeader = this.logHeader + \"openCart>>\";\r\n    if (!Utils.isArrayInvalid(this.shoppingCart)) {\r\n      const popover = await this.popoverController.create({\r\n        component: CartPage,\r\n        event: ev,\r\n        translucent: true,\r\n        cssClass: 'pop-over-style',\r\n        componentProps: {\r\n          cart: this.shoppingCart\r\n        }\r\n      });\r\n      return await popover.present();\r\n    }\r\n    else {\r\n      this.utils.simpleToastError(ToastText.CART_EMPTY);\r\n    }\r\n\r\n  }\r\n\r\n  //-------------------------------------------------------------------------------------------------------------------------------//\r\n\r\n  addToCart(item: CartItem) {\r\n    const logHeader = this.logHeader + \"addToCart>>\";\r\n    Utils.log(logHeader);\r\n    let cartItem=this.shoppingCart.filter(n => n.getPremio().getId() == item.getPremio().getId())[0];\r\n    let elements=new Array<any>();\r\n    if(!Utils.isVarInvalid(cartItem)){\r\n      elements = this.shoppingCart.splice(this.shoppingCart.indexOf(cartItem), 1);\r\n    }\r\n    if (item.getQuantidade() > 0) {\r\n      this.shoppingCart.push(item);\r\n      this.utils.simpleToast(ToastText.INSERTED_IN_CART);\r\n    }\r\n    else if (elements.length > 0) {\r\n      this.utils.simpleToast(ToastText.REMOVED_FROM_CART);\r\n    }\r\n  }\r\n\r\n  //-------------------------------------------------------------------------------------------------------------------------------//\r\n\r\n  loadData(event) {\r\n    setTimeout(() => {\r\n      console.log('Done');\r\n      event.target.complete();\r\n      this.imageConcatString = Utils.generateRandomString();\r\n      if (this.rewardList.length == 1000) {\r\n        event.target.disabled = true;\r\n      }\r\n    }, 500);\r\n  }\r\n\r\n  //-------------------------------------------------------------------------------------------------------------------------------//\r\n\r\n}\r\n"],"sourceRoot":""}